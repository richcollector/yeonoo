<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.noo.wms.company.mapper.CompanySQLMapper">

	<!-- 관리자가 회사 등록 -->
	
	<insert id="insertCompany">
		INSERT into Company (
			company_name,
			company_registration_number,
			company_corporate_registration_number,
			company_representative,
			company_phone,
			company_pax_number,
			company_email,
			company_email_tax,
			company_post_number,
			company_address,
			company_address_detail,
			company_rogo,
			company_wallpaper,
			company_registration,
			company_memo
			) values (
			#{company_name},
			#{company_registration_number},
			#{company_corporate_registration_number},
			#{company_representative},
			#{company_phone},
			#{company_pax_number},
			#{company_email},
			#{company_email_tax},
			#{company_post_number},
			#{company_address},
			#{company_address_detail},
			NULL,
			NULL,
			SYSDATE(),
			#{company_memo})
	</insert>
	
	
	<!-- 회사 등록시 자동으로 어드민 정보에 회사 코드 들어가게 업데이트 -->
	
	<update id="whenRegistCompany">
		UPDATE Admin
		SET company_code = #{companyCode}
		WHERE admin_code = #{adminCode}
	</update>
	
	<!-- 마지막 회사 등록 정보에서 code가져오기 -->
	
	<select id="findLatestRegist" resultType="com.noo.wms.vo.CompanyVo">
		select * from Company 
		ORDER BY company_code DESC LIMIT 1;
	</select>
	
	<!-- 회사 정보 셀렉트 -->
	
	<select id="companyInfo" resultType="com.noo.wms.vo.CompanyVo">
		SELECT * FROM Company
		WHERE company_code = #{companyCode};
	</select>
	
	<!-- session 새로고침-->
	
	<select id="refreshSession" resultType="com.noo.wms.vo.AdminVo">
		select * from Admin
		where admin_email = #{adminEmail}
		and admin_password = #{adminPassword}
	</select>
	
	<!-- 회사 정보 수정  -->
	
	<update id="updateCompany">
		UPDATE Company
			set company_name = #{company_name},
				company_registration_number = #{company_registration_number},
				company_corporate_registration_number = #{company_corporate_registration_number},
				company_representative = #{company_representative},
				company_phone = #{company_phone},
				company_pax_number = #{company_pax_number},
				company_email = #{company_email},
				company_email_tax = #{company_email_tax},
				company_post_number = #{company_post_number},
				company_address = #{company_address},
				company_address_detail = #{company_address_detail},
				company_rogo = #{company_rogo},
				company_wallpaper = #{company_wallpaper},
				company_memo = #{company_memo}
			Where company_code = #{company_code}
	</update>
	
</mapper>